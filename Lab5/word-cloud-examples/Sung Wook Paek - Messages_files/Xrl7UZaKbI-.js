if (self.CavalryLogger) { CavalryLogger.start_js(["kXgSE"]); }

__d("WorkUserAvailabilityStatusType",[],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={NONE:"None",AVAILABLE:"Available",SPORADIC:"Sporadic",TENTATIVE:"Tentative",BUSY:"Busy",DO_NOT_DISTURB:"Do Not Disturb",FOCUS:"Focus"};}),null);
__d('FantaReducersDockCalculator',['Arbiter','FantaTabActions','FantaMessageActions','setImmediate'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('FantaTabActions').Types,i=c('FantaMessageActions').Types,j=null;function k(n){j=n;c('setImmediate')(function(){c('Arbiter').inform('FantaReducersDockCalculator/shouldRecalculate');});}function l(n){if(!j||n.size!==j.size){k(n);}else{var o=false;n.forEach(function(p){var q=j&&j.get(p.id);if(!q||p.isMinimized!==q.isMinimized)o=true;});if(o)k(n);}}function m(n,o){var p=n.tabGroup.tabs;switch(o.type){case h.CLOSE_ALL_TABS:case h.CLOSE_AND_TAB_NEXT:case h.CLOSE_TAB:case h.MINIMIZE_ALL_TABS:case h.MINIMIZE_TAB:case h.OPEN_TAB:case h.UNMINIMIZE_TAB:k(p);break;case h.LOAD_FROM_DATA:case i.RECEIVED_NEW_MESSAGE:l(p);break;}return n;}f.exports={recalculateDock:m};}),null);
__d('FantaTypeTabContents',['immutable','MercuryMessageStore'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j={composerText:'',hasFetchedAll:false,id:'',isUploading:false,messages:c('immutable').List(),messageStore:null,openSheet:null,showContextBanner:false,signatureID:null,thread:null};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('FantaTypeMercuryState',['FantaTypeTabContents','immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j={focusCallbacks:c('immutable').Map({}),blurCallbacks:c('immutable').Map({}),tabContents:c('immutable').Map({})};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('FantaConst',[],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={DEFAULT_ALLOWED_RAISED_TABS:2,DEFAULT_MESSAGE_COUNT:10};f.exports=h;}),null);
__d('FantaTypeTab',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j={focusCounter:0,id:'',isMinimized:false,openCounter:0,focusOnMountDEPRECATED:false};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('FantaTypeTabGroup',['FantaConst','FantaTypeTab','immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j={allowedRaisedTabs:c('FantaConst').DEFAULT_ALLOWED_RAISED_TABS,focusedTabID:null,tabs:c('immutable').Map({}),updatedTime:0};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;k.prototype.getRaisedandUnraisedTabs=function(){var l=function q(r){return r.openCounter;},m=function q(r){return r.focusCounter*-1;},n=this.tabs.sortBy(m),o=n.slice(this.allowedRaisedTabs),p=n.take(this.allowedRaisedTabs).sortBy(l);return {raisedTabs:p,unraisedTabs:o};};function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('FantaTypeAppState',['FantaTypeMercuryState','FantaTypeTabGroup','immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j={tabGroup:new (c('FantaTypeTabGroup'))(),mercury:new (c('FantaTypeMercuryState'))()};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('WorkFocusMode',['WorkModeConfig','WorkUserAvailabilityStatusType','emptyFunction','ifRequired'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={},i={status:'AVAILABLE',end_date:0};if(c('WorkModeConfig').availability){i.status=c('WorkModeConfig').availability.status;i.end_date=c('WorkModeConfig').availability.end_date;}f.exports={updateAvailability:function j(k,l){k=Object.keys(c('WorkUserAvailabilityStatusType')).find(function(m){return c('WorkUserAvailabilityStatusType')[m]===k;});i.status=k;i.end_date=l;},currentViewerInFocusMode:function j(k){if(!c('WorkModeConfig').focus_messaging_enabled)return false;if(k){if(h[k])return false;var l=null;c('ifRequired')('MercuryThreads',function(n){l=n.get().getThreadMetaNow(k);},c('emptyFunction'));if(l&&l.bypass_focus_mode_until&&l.bypass_focus_mode_until>Date.now()/1000)return false;}var m=c('WorkUserAvailabilityStatusType')[i.status];if(m===c('WorkUserAvailabilityStatusType').FOCUS&&i.end_date*1000>Date.now())return true;return false;},addBypassFocusModeForThread:function j(k){h[k]=true;},removeBypassFocusModeForThread:function j(k){h[k]=false;}};}),null);
__d('FantaReducersMercury',['Arbiter','Bootloader','FantaTabActions','FantaTypeAppState','FantaTypeTabContents','JSLogger','MercuryIDs','MercuryThreadIDMap','WorkFocusMode','ifRequired','setImmediate'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreadIDMap').get(),i=c('JSLogger').create('FantaReducersMercury'),j=c('FantaTabActions').Types;function k(){return Math.floor(Math.random()*2147483648).toString(16);}function l(aa,ba){switch(ba.type){case j.OPEN_TAB:var ca=ba.tabID;c('ifRequired')('FantaTabsApp',function(ea){if(!c('MercuryIDs').isValidThreadID(ca)){aa=aa.deleteIn(['tabGroup','tabs',ca]);o(ca);}else y(ca);},function(){c('ifRequired')('FantaTabsSlimApp',function(ea){if(!c('MercuryIDs').isValidThreadID(ba.tabID)){aa=aa.deleteIn(['tabGroup','tabs',ba.tabID]);o(ba.tabID);}else y(ba.tabID);},function(){y(ba.tabID);});});aa=m(aa,ca);var da=k();aa=aa.mergeIn(['mercury','tabContents',ca],{signatureID:da});c('Arbiter').inform('jewel/hide');return aa;}return aa;}function m(aa,ba){var ca=aa.mercury.tabContents.get(ba);if(!ca)return aa.setIn(['mercury','tabContents',ba],new (c('FantaTypeTabContents'))({id:ba}));return aa;}function n(aa,ba){switch(ba.type){case j.REPLACE_TAB:c('ifRequired')('FantaTabsApp',function(ca){if(!c('MercuryIDs').isValidThreadID(ba.newTabID)){aa=aa.deleteIn(['tabGroup','tabs',ba.newTabID]);o(ba.newTabID);}},function(){c('ifRequired')('FantaTabsSlimApp',function(ca){if(!c('MercuryIDs').isValidThreadID(ba.newTabID)){aa=aa.deleteIn(['tabGroup','tabs',ba.newTabID]);o(ba.newTabID);}});});aa=m(aa,ba.newTabID);return aa;}return aa;}function o(aa){h.getClientIDFromServerID(aa,function(ba){return c('setImmediate')(function(){if(c('MercuryIDs').isValidThreadID(ba)){c('FantaTabActions').openTab(ba);}else i.error('invalid id',aa);});});}function p(aa,ba){switch(ba.type){case j.MERCURY_REGISTER_TAB_FOCUS_DEPRECATED:aa=s(aa,ba);aa=t(aa,ba);var ca=aa.tabGroup.tabs.get(ba.tabID);if(ca&&ca.focusOnMountDEPRECATED)return r(aa,ba.tabID);}return aa;}function q(aa,ba){switch(ba.type){case j.FOCUS_TAB:return r(aa,ba.tabID);}return aa;}function r(aa,ba){var ca=aa.mercury.get('focusCallbacks'),da=aa.mercury.get('blurCallbacks'),ea=ca.get(ba);for(var fa=da.values(),ga=Array.isArray(fa),ha=0,fa=ga?fa:fa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ia;if(ga){if(ha>=fa.length)break;ia=fa[ha++];}else{ha=fa.next();if(ha.done)break;ia=ha.value;}var ja=ia;ja();}if(ea)ea();aa=aa.mergeIn(['tabGroup','tabs',ba],{focusOnMountDEPRECATED:false});return aa;}function s(aa,ba){var ca=ba.tabID,da=ba.focusCallback;return aa.setIn(['mercury','focusCallbacks',ca],da);}function t(aa,ba){var ca=ba.tabID,da=ba.blurCallback;return aa.setIn(['mercury','blurCallbacks',ca],da);}function u(aa,ba){switch(ba.type){case j.CLOSE_TAB:var ca=ba.tabID;c('ifRequired')('MessengerVideoAutoplayActions',function(da){da.deleteThread(ca);});c('WorkFocusMode')&&c('WorkFocusMode').removeBypassFocusModeForThread(ca);return aa.deleteIn(['mercury','focusCallbacks',ca]).deleteIn(['mercury','blurCallbacks',ca]);}return aa;}function v(aa,ba){switch(ba.type){case j.CLOSE_ALL_TABS:var ca=aa.mercury.get('focusCallbacks'),da=aa.mercury.get('blurCallbacks');c('ifRequired')('MessengerVideoAutoplayActions',function(ea){ea.deleteAllThreads();});return aa.setIn(['mercury','focusCallbacks'],ca.clear()).setIn(['mercury','blurCallbacks'],da.clear());}return aa;}function w(aa,ba){switch(ba.type){case j.FOCUS_NEXT_TAB:case j.FOCUS_PREVIOUS_TAB:case j.CLOSE_AND_TAB_NEXT:var ca=aa.tabGroup.focusedTabID;if(ca)r(aa,ca);}return aa;}function x(aa,ba){switch(ba.type){case j.CLOSE_AND_TAB_NEXT:var ca=ba.tabID;c('WorkFocusMode')&&c('WorkFocusMode').removeBypassFocusModeForThread(ca);}return aa;}function y(aa){if(!c('MercuryIDs').isValidThreadID(aa))return;c('Bootloader').loadModules(["GroupChatMessageBlockAlert","MercuryBlockedParticipants","MercuryThreadActions","MercuryThreads"],function(ba,ca,da,ea){var fa=da.get(),ga=ea.get(),ha=ca.get();ga.getThreadMeta(aa,function(ia){if(ha.isPresentInGroupThread(ia))ba.show(ha.inGroupThread(ia),function(){c('FantaTabActions').focusTab(aa);},function(){c('FantaTabActions').closeTab(aa);fa.leaveGroup(aa);});});},'FantaReducersMercury');}function z(aa,ba){switch(ba.type){case j.LOAD_FROM_DATA:for(var ca=aa.tabGroup.tabs.keys(),da=Array.isArray(ca),ea=0,ca=da?ca:ca[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var fa;if(da){if(ea>=ca.length)break;fa=ca[ea++];}else{ea=ca.next();if(ea.done)break;fa=ea.value;}var ga=fa;aa=m(aa,ga);}}return aa;}f.exports={closeAllTabs:v,closeAndTabNext:x,closeTab:u,focusTab:q,focusTabEvents:w,loadFromData:z,openTab:l,registerTabFocusDeprecated:p,replaceTab:n};}),null);
__d('FantaReducersMessages',['ChatMentionsNotifications','FantaMessageActions','FantaTabActions','FantaTypeAppState','MercuryBrowserAlerts','MercuryConfig'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('FantaMessageActions').Types,i=c('FantaTabActions').Types;function j(n,o){switch(o.type){case h.RECEIVED_NEW_MESSAGE:var p=o.message;if(c('MercuryConfig').DesktopNotificationsGK)c('ChatMentionsNotifications').notifyIfMessageToMe(p);c('MercuryBrowserAlerts').messageReceived(p);return n;}return n;}function k(n,o){switch(o.type){case h.COMPOSER_TEXT_UPDATE:var p=o.message,q=o.threadID;return n.mergeIn(['mercury','tabContents',q],{composerText:p});}return n;}function l(n,o){switch(o.type){case i.CLOSE_TAB:return n.mergeIn(['mercury','tabContents',o.tabID],{composerText:''});}return n;}function m(n,o){switch(o.type){case i.CLOSE_ALL_TABS:var p=n.mercury.tabContents;p.forEach(function(q){var r=q.id;n=n.setIn(['mercury','tabContents',r],q.set('composerText',''));});return n;}return n;}f.exports={closeAllTabs:m,closeTab:l,composerTextUpdate:k,receivedNewMessage:j};}),null);
__d('FantaTabSheetActions',['FantaDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('keyMirror')({CLOSE_NAME_CONVERSATION_TAB_SHEET:null,CLOSE_OFFLINE_TAB_SHEET:null,CLOSE_READ_ONLY_PERMANENT_SHEET:null,CLOSE_READ_ONLY_SHEET:null,CLOSE_THREAD_IS_MUTED_TAB_SHEET:null,OPEN_NAME_CONVERSATION_TAB_SHEET:null,OPEN_OFFLINE_TAB_SHEET:null,OPEN_READ_ONLY_PERMANENT_SHEET:null,OPEN_READ_ONLY_SHEET:null,OPEN_THREAD_IS_MUTED_TAB_SHEET:null}),i={Types:h,openThreadIsMutedTabSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_THREAD_IS_MUTED_TAB_SHEET,tabID:k});},closeThreadIsMutedTabSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_THREAD_IS_MUTED_TAB_SHEET,tabID:k});},openNameConversationSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_NAME_CONVERSATION_TAB_SHEET,tabID:k});},closeNameConversationSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_NAME_CONVERSATION_TAB_SHEET,tabID:k});},openOfflineSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_OFFLINE_TAB_SHEET,tabID:k});},closeOfflineSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_OFFLINE_TAB_SHEET,tabID:k});},openReadOnlySheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_READ_ONLY_SHEET,tabID:k});},closeReadOnlySheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_READ_ONLY_SHEET,tabID:k});},openReadOnlyPermanentSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_READ_ONLY_PERMANENT_SHEET,tabID:k});},closeReadOnlyPermanentSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_READ_ONLY_PERMANENT_SHEET,tabID:k});}};f.exports=i;}),null);
__d('FantaReducersTabSheets',['FantaTabActions','FantaTabSheetActions','FantaTypeAppState','MercurySheetPolicy'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('FantaTabActions').Types,i=c('FantaTabSheetActions').Types;function j(ka,la){switch(la.type){case h.CLOSE_TAB:var ma=la.tabID;return k(ka,ma);}return ka;}function k(ka,la,ma){var na=ka.mercury.tabContents.get(la);if(!na)return ka;if(ma&&na.openSheet!==ma)return ka;return ka.mergeIn(['mercury','tabContents',la],{openSheet:null});}function l(ka,la){switch(la.type){case h.CLOSE_ALL_TABS:for(var ma=ka.mercury.tabContents.keys(),na=Array.isArray(ma),oa=0,ma=na?ma:ma[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var pa;if(na){if(oa>=ma.length)break;pa=ma[oa++];}else{oa=ma.next();if(oa.done)break;pa=oa.value;}var qa=pa;ka=k(ka,qa);}}return ka;}function m(ka,la,ma){var na=ka.mercury.tabContents.get(la),oa=ka.tabGroup.tabs.get(la);if(!oa)return ka;var pa=na.openSheet;if(pa&&!c('MercurySheetPolicy').canReplaceOpenSheet(pa,ma))return ka;ka=ka.mergeIn(['mercury','tabContents',la],{openSheet:ma});return ka;}function n(ka,la){return ka;}function o(ka,la){return ka;}function p(ka,la){return ka;}function q(ka,la){return ka;}function r(ka,la){return ka;}function s(ka,la){return ka;}function t(ka,la){switch(la.type){case i.OPEN_NAME_CONVERSATION_TAB_SHEET:return m(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet);}return ka;}function u(ka,la){switch(la.type){case i.CLOSE_NAME_CONVERSATION_TAB_SHEET:return k(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet);}return ka;}function v(ka,la){return ka;}function w(ka,la){return ka;}function x(ka,la){switch(la.type){case i.OPEN_OFFLINE_TAB_SHEET:return m(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);}return ka;}function y(ka,la){switch(la.type){case i.CLOSE_OFFLINE_TAB_SHEET:return k(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);}return ka;}function z(ka,la){switch(la.type){case i.OPEN_READ_ONLY_PERMANENT_SHEET:return m(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}return ka;}function aa(ka,la){switch(la.type){case i.CLOSE_READ_ONLY_PERMANENT_SHEET:return k(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}return ka;}function ba(ka,la){switch(la.type){case i.OPEN_READ_ONLY_SHEET:return m(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyTabSheet);}return ka;}function ca(ka,la){switch(la.type){case i.CLOSE_READ_ONLY_SHEET:return k(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyTabSheet);}return ka;}function da(ka,la){switch(la.type){case i.OPEN_THREAD_IS_MUTED_TAB_SHEET:return m(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}return ka;}function ea(ka,la){switch(la.type){case i.CLOSE_THREAD_IS_MUTED_TAB_SHEET:return k(ka,la.tabID,c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}return ka;}function fa(ka,la){return ka;}function ga(ka,la){return ka;}function ha(ka,la){return ka;}function ia(ka,la){return ka;}function ja(ka,la){return ka;}f.exports={closeAllTabs:l,closeNameConversationSheet:u,closeOfflineSheet:y,closePermanentReadOnlySheet:aa,closeReadOnlySheet:ca,closeTab:j,closeThreadIsMutedTabSheet:ea,openAddFriendsSheet:n,openAppointmentBannerSheet:o,openBypassFocusSheet:p,openEmployeeAwaySheet:q,openMessageBlockedTabSheet:r,openMontageSheet:s,openNameConversationSheet:t,openNewMessagesSheet:v,openNoRecipientsSheet:w,openOfflineSheet:x,openPermanentReadOnlySheet:z,openReadOnlySheet:ba,openThreadIsMutedTabSheet:da,openUploadWarningTabSheet:fa,openUserBlockedSheet:ga,openUserFocusSheet:ha,openUserIsPersonalUserSheet:ia,openUserTimezoneSheet:ja};}),null);
__d('FantaReducersTabs',['FantaConst','FantaTabActions','FantaMessageActions','FantaTypeAppState','FantaTypeTab','FantaTypeTabGroup','URI','isWebMessengerURI'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('FantaTabActions').Types,i=c('FantaMessageActions').Types,j='tab_',k=1,l=1,m=1;function n(ka,la){switch(la.type){case h.OPEN_TAB:ka=u(ka);return v(ka,la.tabID||j+m++,true);}return ka;}function o(ka,la){switch(la.type){case h.REPLACE_TAB:var ma=la.tabID,na=la.newTabID;ka=u(ka);var oa=ka.tabGroup,pa=oa.tabs,qa=pa.get(ma);if(qa)ka=ka.setIn(['tabGroup','tabs',na],qa.merge({id:na})).deleteIn(['tabGroup','tabs',ma]);return v(ka,na);}return ka;}function p(ka,la){switch(la.type){case h.MINIMIZE_TAB:ka=u(ka);return w(ka,la.tabID,true);}return ka;}function q(ka,la){switch(la.type){case h.UNMINIMIZE_TAB:ka=u(ka);return w(ka,la.tabID,false);}return ka;}function r(ka,la){switch(la.type){case h.FOCUS_TAB:ka=u(ka);return ca(ka,la.tabID);}return ka;}function s(ka,la){switch(la.type){case h.BLUR_TAB:ka=u(ka);return da(ka,la.tabID);}return ka;}function t(ka,la){switch(la.type){case i.RECEIVED_NEW_MESSAGE:var ma=la.tabID,na=ka.tabGroup.tabs.get(ma);ka=u(ka);if(!na){var oa=ka.tabGroup.focusedTabID;ka=v(ka,ma,false);var pa=c('URI').getNextURI();if(c('isWebMessengerURI')(pa)){return ka=w(ka,ma,true);}else if(oa)return ca(ka,oa);}}return ka;}function u(ka){return ka.mergeIn(['tabGroup'],{updatedTime:Date.now()});}function v(ka,la,ma){var na=ka.tabGroup,oa=na.tabs,pa=oa.get(la);if(!pa){pa=new (c('FantaTypeTab'))({id:la,focusCounter:k,openCounter:l++,focusOnMountDEPRECATED:ma});ka=ka.setIn(['tabGroup','tabs',la],pa);}else if(pa.isMinimized&&ma)ka=w(ka,la,false);if(ma)return ca(ka,la);return ka;}function w(ka,la,ma){var na=ka.tabGroup,oa=na.tabs.get(la);if(oa)ka=ka.mergeIn(['tabGroup','tabs',la],{isMinimized:ma});return ka;}function x(ka,la){switch(la.type){case h.MINIMIZE_ALL_TABS:ka=u(ka);for(var ma=ka.tabGroup.tabs.keys(),na=Array.isArray(ma),oa=0,ma=na?ma:ma[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var pa;if(na){if(oa>=ma.length)break;pa=ma[oa++];}else{oa=ma.next();if(oa.done)break;pa=oa.value;}var qa=pa;ka=w(ka,qa,true);}return ka;}return ka;}function y(ka,la){switch(la.type){case h.CLOSE_TAB:var ma=la.tabID;ka=u(ka);return z(ka,ma);}return ka;}function z(ka,la){ka=da(ka,la);return ka.deleteIn(['tabGroup','tabs',la]);}function aa(ka,la){switch(la.type){case h.CLOSE_ALL_TABS:ka=u(ka);ka=da(ka,ka.tabGroup.focusedTabID);return ka.setIn(['tabGroup','tabs'],ka.tabGroup.tabs.clear());}return ka;}function ba(ka,la){switch(la.type){case h.CLOSE_AND_TAB_NEXT:ka=u(ka);ka=z(ka,la.tabID);return ia(ka);}return ka;}function ca(ka,la){var ma=ka.tabGroup,na=ma.tabs.get(la);if(na)ka=ka.mergeIn(['tabGroup','tabs',la],{focusCounter:k++});ka=ka.mergeIn(['tabGroup'],{focusedTabID:la});return ka;}function da(ka,la){if(ka.tabGroup.focusedTabID===la)return ka.mergeIn(['tabGroup'],{focusedTabID:null});return ka;}function ea(ka,la){switch(la.type){case h.SET_ALLOWED_RAISED_TABS:return fa(ka,la.allowedRaisedTabs);}return ka;}function fa(ka){var la=arguments.length<=1||arguments[1]===undefined?c('FantaConst').DEFAULT_ALLOWED_RAISED_TABS:arguments[1];if(la===ka.tabGroup.allowedRaisedTabs)return ka;return ka.mergeIn(['tabGroup'],{allowedRaisedTabs:Math.max(1,la)});}function ga(ka,la){switch(la.type){case h.LOAD_FROM_DATA:var ma=ka.tabGroup,na=la.tabData;if(ma.updatedTime>=na.updatedTime||na.updatedTime===undefined)return ka;ka=fa(ka.set('tabGroup',new (c('FantaTypeTabGroup'))()),ma.allowedRaisedTabs);na.tabs.sort(function(oa,pa){return oa.openCounter-pa.openCounter;}).forEach(function(oa){ka=v(ka,oa.id,false);if(oa.isMinimized)ka=w(ka,oa.id,oa.isMinimized);});na.tabs.sort(function(oa,pa){return oa.focusCounter-pa.focusCounter;}).forEach(function(oa){ka=ca(ka,oa.id,true);});ka=na.focusedTabID?ca(ka,na.focusedTabID,true):da(ka);return ka.mergeIn(['tabGroup'],{updatedTime:na.updatedTime});}return ka;}function ha(ka,la){switch(la.type){case h.FOCUS_NEXT_TAB:ka=u(ka);return ia(ka,la.event);}return ka;}function ia(ka,event){var la=ka.tabGroup.focusedTabID,ma=ka.tabGroup.getRaisedandUnraisedTabs(),na=ma.raisedTabs,oa=na.count();if(oa===0){return ka;}else if(na.count()===1)return ca(ka,na.first().id);if(event)event.preventDefault();var pa=na.skipUntil(function(qa){return qa.id===la;}).rest();if(pa.count()===0){return ca(ka,na.first().id);}else return ca(ka,pa.first().id);}function ja(ka,la){switch(la.type){case h.FOCUS_PREVIOUS_TAB:var ma=ka.tabGroup.focusedTabID,na=ka.tabGroup.getRaisedandUnraisedTabs(),oa=na.raisedTabs;if(oa.count()<2)return ka;var event=la.event;if(event)event.preventDefault();ka=u(ka);var pa=oa.reverse().skipUntil(function(qa){return qa.id===ma;}).rest();if(pa.count()===0){return ca(ka,oa.last().id);}else return ca(ka,pa.first().id);}return ka;}f.exports={blurTab:s,closeAllTabs:aa,closeAndTabNext:ba,closeTab:y,focusNextTab:ha,focusPreviousTab:ja,focusTab:r,loadFromData:ga,minimizAllTabs:x,minimizeTab:p,openTab:n,receivedNewMessage:t,replaceTab:o,setAllowedRaisedTabs:ea,unminimizeTab:q};}),null);
__d('FantaAppStore',['FantaDispatcher','FantaReducersDockCalculator','FantaReducersMercury','FantaReducersMessages','FantaReducersTabs','FantaReducersTabSheets','FantaTypeAppState','FluxReduceStore'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=[].concat(Object.values(c('FantaReducersTabs')),Object.values(c('FantaReducersMercury')),Object.values(c('FantaReducersTabSheets')),Object.values(c('FantaReducersMessages')),Object.values(c('FantaReducersDockCalculator')));h=babelHelpers.inherits(k,c('FluxReduceStore'));i=h&&h.prototype;k.prototype.getInitialState=function(){return new (c('FantaTypeAppState'))();};k.prototype.ignoreReducer=function(l){var m;};k.prototype.addReducers=function(l){j=j.concat(Object.values(l));};k.prototype.reduce=function(l,m){return j.reduce(function(n,o){return o(n,m);},l);};function k(){h.apply(this,arguments);}f.exports=new k(c('FantaDispatcher'));}),null);
__d('FantaCookieUtil',['FantaTypeTabGroup','MercuryIDs','MercuryThreads','WorkModeConfig'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreads').get(),i={convertCookieData:function j(k,l){var m={tabs:[],focusedTabID:null,updatedTime:0},n=[],o=this._getCookieKeys();if(k[o.tabs]){n=k[o.tabs];}else if(k.t2)n=k.t2;n.forEach(function(u){m.tabs.push({id:u.i,isMinimized:!u.r,openCounter:u.o,focusCounter:u.f});});if(l)for(var p=l.tabs.values(),q=Array.isArray(p),r=0,p=q?p:p[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var s;if(q){if(r>=p.length)break;s=p[r++];}else{r=p.next();if(r.done)break;s=r.value;}var t=s;if(h.isEmptyLocalThread(t.id))m.tabs.push({id:t.id,isMinimized:t.isMinimized,openCounter:t.openCounter,focusCounter:t.focusCounter});}m.focusedTabID=k[o.focusedTabID]||k.lm2;m.updatedTime=k[o.updatedTime];return m;},createCookieData:function j(k,l){var m=[],n=this._getCookieKeys();for(var o=k.tabs.values(),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var r;if(p){if(q>=o.length)break;r=o[q++];}else{q=o.next();if(q.done)break;r=q.value;}var s=r;if(!c('MercuryIDs').isLocalThread(s.id))m.push({i:s.id,r:s.isMinimized?undefined:1,o:s.openCounter,f:s.focusCounter});}l[n.tabs]=m;l[n.focusedTabID]=k.focusedTabID;l[n.updatedTime]=k.updatedTime;return l;},_getCookieKeys:function j(){var k=c('WorkModeConfig').is_work_user;return {tabs:k?'t3w':'t3',focusedTabID:k?'lm3w':'lm3',updatedTime:k?'utc3w':'utc3'};}};f.exports=i;}),null);
__d('FantaMercuryTabBody.react',['Bootloader','FantaTabActions','FantaTypeTab','FantaTypeTabContents','React','ReactDOM','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.prototype.componentDidMount=function(){var k=this.props,l=k.isLastTab,m=k.tab,n=k.tabContent,o='',p=n&&n.signatureID,q=c('ReactDOM').findDOMNode(this.refs.root),r=m.id,s=m.focusOnMountDEPRECATED;c('Bootloader').loadModules(["ChatTabView"],function(t){this.$FantaMercuryTabBody1=new t(r,o,p,q,null,l);this.$FantaMercuryTabBody1.setVisibleState(true,!m.isMinimized);c('setImmediate')(function(){c('FantaTabActions').registerTabFocusDeprecated(r,function(){return this.$FantaMercuryTabBody1.focusTab();}.bind(this),function(){return this.$FantaMercuryTabBody1.blurTab();}.bind(this),s);}.bind(this));}.bind(this),'FantaMercuryTabBody.react');};j.prototype.componentWillReceiveProps=function(k){var l=k.isLastTab;if(this.$FantaMercuryTabBody1)this.$FantaMercuryTabBody1.updateIsLastTab(l);};j.prototype.render=function(){return c('React').createElement('div',{ref:'root'});};j.prototype.componentWillUnmount=function(){if(this.$FantaMercuryTabBody1)this.$FantaMercuryTabBody1.destroy();};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d('FantaMercuryTabOverflowBootloader.react',['BootloadOnRender.react','FantaTypeTab','immutable','JSResource','LazyComponent.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.prototype.render=function(){return (c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{items:this.props.items}),loader:c('JSResource')('FantaMercuryTabOverflow.react').__setRef('FantaMercuryTabOverflowBootloader.react'),placeholder:c('React').createElement('div',null)}));};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d('FantaTab.react',['cx','FantaTypeTab','FantaTypeTabContents','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.render=function(){var l=this.props,m=l.MainComponent,n=l.MinimizedComponent,o=l.isFocused,p=l.isLastTab,q=l.isLastTabOfType,r=l.tab,s=l.tabContent,t=r.isMinimized?n:m,u=r.id+(r.isMinimized?'-minimized':'-maximized');return (c('React').createElement('div',{className:"_5qi9"+(' '+"_5qib")+(this.props.isFocused?' '+"_5qic":'')+(r.isMinimized?' '+"_3001":'')},c('React').createElement(t,{key:u,tab:r,tabContent:s,isFocused:o,isLastTab:p,isLastTabOfType:q})));};function k(){i.apply(this,arguments);}f.exports=k;}),null);
__d('FantaTabGroup.react',['cx','FantaTab.react','FantaTypeTab','FantaTypeTabContents','FantaTypeTabGroup','immutable','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').OrderedMap;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.shouldComponentUpdate=function(m){return !this.props.tabGroup.equals(m.tabGroup);};l.prototype.render=function(){var m=this.props,n=m.isLastOfTypeChecker,o=m.MainComponent,p=m.MinimizedComponent,q=m.OverflowComponent,r=m.tabContents,s=m.tabGroup,t=s.focusedTabID,u=s.getRaisedandUnraisedTabs(),v=u.raisedTabs,w=u.unraisedTabs,x=void 0;if(n)x=v.findLastKey(function(y){return n(y)&&y.id;});return (c('React').createElement('div',{className:"_59v1"},this.$FantaTabGroup1(w,q),v.map(function(y){return (c('React').createElement(c('FantaTab.react'),{key:y.id,tab:y,isFocused:y.id===t,isLastTab:y===v.last(),isLastTabOfType:y.id===x,MainComponent:o,MinimizedComponent:p,tabContent:r&&r.get(y.id)}));}).toArray()));};l.prototype.$FantaTabGroup1=function(m,n){if(!m.isEmpty())return (c('React').createElement('div',{className:"_1kws"},c('React').createElement(n,{items:m})));return null;};function l(){i.apply(this,arguments);}f.exports=l;}),null);
__d('FantaMercuryTabs.react',['FantaAppStore','FantaCookieUtil','FantaMercuryTabBody.react','FantaMercuryTabOverflowBootloader.react','FantaTabActions','FantaTabGroup.react','FantaTypeTabContents','FantaTypeTabGroup','FluxContainer','PresenceState','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.getStores=function(){return [c('FantaAppStore')];};j.calculateState=function(){return {tabContents:c('FantaAppStore').getState().mercury.tabContents,tabGroup:c('FantaAppStore').getState().tabGroup};};j.prototype.componentWillMount=function(){if(this.props.loadDataOnMount)c('FantaTabActions').loadFromData(c('FantaCookieUtil').convertCookieData(c('PresenceState').get()));};j.prototype.render=function(){return (c('React').createElement(c('FantaTabGroup.react'),{MainComponent:c('FantaMercuryTabBody.react'),MinimizedComponent:c('FantaMercuryTabBody.react'),OverflowComponent:c('FantaMercuryTabOverflowBootloader.react'),tabContents:this.state.tabContents,tabGroup:this.state.tabGroup}));};function j(){h.apply(this,arguments);}f.exports=c('FluxContainer').create(j);}),null);
__d('FantaMercuryThreadEventsBootloaded',['Bootloader','MercuryThreadInformer','MercuryThreads','MercuryViewer'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreadInformer').get(),i=c('MercuryThreads').get(),j={onMessagesReceived:function k(l){h.subscribe('messages-received',function(m,n){var o,p=function r(s){var t,u=n[s],v=function x(y){var z=u[y];if(z.author!=c('MercuryViewer').getID()){if(!z.is_unread)return 'continue';i.getThreadMeta(s,function(aa){c('Bootloader').loadModules(["ChatTabPolicy"],function(ba){ba.messageIsAllowed(aa,z,function(){l(s,z);});},'FantaMercuryThreadEventsBootloaded');});}};for(var w=0;w<u.length;w++){var t=v(w);if(t==='continue')continue;}};for(var q in n)p(q);});}};f.exports=j;}),null);
__d('FantaTabViewportManager',['Arbiter','DockTabsViewportCalculator','DockTabsViewportFantaTabUtils','FantaTabActions','immutable','ifRequired','isWebMessengerURI'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=c('DockTabsViewportCalculator').getInstance(i);if(!j)return;j.registerFantaTabCallbacks({fantaTabModelStateGetter:function k(){var l=c('immutable').Map({});c('ifRequired')('FantaAppStore',function(m){l=m.getState().tabGroup.tabs;});return l;},onAvailableWidthChanged:function k(l){c('FantaTabActions').setAllowedRaisedTabs(c('DockTabsViewportFantaTabUtils').getTabCountToFitWidth(l));}});c('Arbiter').subscribe('FantaReducersDockCalculator/shouldRecalculate',function(){j.forceRecalculateChatTabs();});j.forceRecalculateFBDockWidth();c('Arbiter').subscribe('page_transition',function(k,l){if(c('isWebMessengerURI')(l.uri))c('FantaTabActions').minimizeAllTabs();});}f.exports={init:h};}),null);
__d('FantaTabsAppBase',['ChatAppActions','ChatAppStore','ChatPerfInstrumentation','CSS','JSLogger'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();h.prototype.init=function(i,j,k){if(this.isInitialized()){c('JSLogger').create('chat_app').error('repeated_init');return;}this.$FantaTabsAppBase1=i;this.tabsElem=j;var l=c('ChatAppStore').addListener(function(){var m=c('ChatAppStore').getPreviousState(),n=c('ChatAppStore').getState();if(m.initialDisplayDone===false&&n.initialDisplayDone===true){c('ChatPerfInstrumentation').logDisplayDone();l.remove();}});c('ChatPerfInstrumentation').init();this.$FantaTabsAppBase2();this.initializeFantaData(k);this.initializeFantaUI();this.$FantaTabsAppBase3();c('ChatAppActions').tti();c('ChatPerfInstrumentation').logTTI();};h.prototype.isInitialized=function(){return !!c('ChatAppStore').getState().isInitialized;};h.prototype.isHidden=function(){var i=c('ChatAppStore').getState();return !!(!i.isInitialized||i.isHidden);};h.prototype.hide=function(){if(this.isHidden())return;c('CSS').hide(this.$FantaTabsAppBase1);c('ChatAppActions').hide();};h.prototype.unhide=function(){var i=c('ChatAppStore').getState();if(i.isInitialized){if(i.isHidden){c('CSS').show(this.$FantaTabsAppBase1);e(['Dock'],function(j){j.resizeAllFlyouts();});c('ChatAppActions').unhide();}}else if(!i.isLoaded){e(['UIPagelet'],function(j){j.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');j.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet');});c('ChatAppActions').load();}};h.prototype.initializeFantaData=function(i){};h.prototype.initializeFantaUI=function(){};h.prototype.$FantaTabsAppBase2=function(){e(['MercuryBlockedParticipants','MercuryChannelHandlerDEPRECATED','MercuryDelayedRoger','MercuryDeliveryReceipts','MercuryDeliveryState','MercuryParticipants','MercuryThreads','MercuryUnreadState','MercuryUnseenState','MercurySyncEnvironment','P2PSendMoneyDialogStore','OmniMStore'],function(i,j,k,l,m,n,o,p,q,r,s,t){i.get();j.get().turnOn();k.get();l.get();m.get();n;o.get();q.get();p.get();r.setUp();t.setUp();c('ChatPerfInstrumentation').logInitStores();});};h.prototype.$FantaTabsAppBase3=function(){e(['HotLikeSound','ChatOptions'],function(i,j){i.setCheckSoundEnabledFunc(function(){return j.getSetting('sound');});c('ChatPerfInstrumentation').logInitSound();});};function h(){}f.exports=h;}),null);
__d('FantaTabsApp',['BootloadOnRender.react','ChatPerfInstrumentation','FantaMercuryTabs.react','FantaTabsAppBase','JSResource','LazyComponent.react','MercuryConfig','React','ReactDOM'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FantaTabsAppBase'));i=h&&h.prototype;j.prototype.initializeFantaData=function(k){e(['FantaAppStore','FantaCookieUtil','FantaTabActions','MercuryServerPayloadPreprocessor','PresenceState'],function(l,m,n,o,p){n.loadFromData(m.convertCookieData(p.get()));p.registerStateLoader(function(q){return n.loadFromData(m.convertCookieData(q,l.getState().tabGroup));});p.registerStateStorer(function(q){return m.createCookieData(l.getState().tabGroup,q);});l.addListener(function(){return p.doSync();});o.get().handleUpdate(k);c('ChatPerfInstrumentation').logInitData();});};j.prototype.initializeFantaUI=function(){e(['FantaAppStore','FantaMercuryThreadEventsBootloaded','FantaMessageActions','FantaTabActions','FantaTabViewportManager','FBRTCMessageHandler','MercuryBrowserAlerts'],function(k,l,m,n,o,p,q){p.init();q.init();c('ReactDOM').render(this.getViewComponent(),this.tabsElem);l.onMessagesReceived(function(s,t){m.receivedNewMessage(s,t);});o.init(this.tabsElem);c('ChatPerfInstrumentation').logInitUI();var r=k.getState().tabGroup.tabs;if(r.toArray().length===0)c('ChatPerfInstrumentation').logDisplayDone();}.bind(this));};j.prototype.getViewComponent=function(){if(c('MercuryConfig').FantaTabView)return (c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),null),loadDataOnMount:false,loader:c('JSResource')('FantaMercuryTabsWithMain.react').__setRef('FantaTabsApp'),placeholder:c('React').createElement('div',null)}));return c('React').createElement(c('FantaMercuryTabs.react'),{loadDataOnMount:false});};function j(){h.apply(this,arguments);}f.exports=new j();}),null);
__d('FantaTabsSlimApp',['Bootloader','BootloadOnRender.react','ChatPerfInstrumentation','FantaTabsAppBase','JSResource','LazyComponent.react','MercuryConfig','React','ReactDOM','ifRequired'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FantaTabsAppBase'));i=h&&h.prototype;function j(){var k,l;for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return l=(k=i.constructor).call.apply(k,[this].concat(n)),this.$FantaTabsSlimApp1=false,this.$FantaTabsSlimApp3=function(p,q){if(this.$FantaTabsSlimApp1){c('ifRequired')('FantaMessageActions',function(r){r.receivedNewMessage(p,q);});}else this.$FantaTabsSlimApp2(function(){c('ifRequired')('FantaMessageActions',function(r){r.receivedNewMessage(p,q);});});}.bind(this),l;}j.prototype.getPumpedUp=function(k){if(this.$FantaTabsSlimApp1){k();}else this.$FantaTabsSlimApp2(k);};j.prototype.getViewComponent=function(){if(c('MercuryConfig').FantaTabView){return c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),null),loadDataOnMount:false,loader:c('JSResource')('FantaMercuryTabsWithMain.react').__setRef('FantaTabsSlimApp'),placeholder:c('React').createElement('div',null)});}else return c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),null),loadDataOnMount:false,loader:c('JSResource')('FantaMercuryTabs.react').__setRef('FantaTabsSlimApp'),placeholder:c('React').createElement('div',null)});};j.prototype.initializeFantaData=function(k){e(['FantaCookieUtil','MercuryServerPayloadPreprocessor','PresenceState'],function(l,m,n){n.registerStateLoader(function(o){var p,q=this;if(this.$FantaTabsSlimApp1){c('ifRequired')('FantaTabActions',function(r){c('ifRequired')('FantaAppStore',function(s){r.loadFromData(l.convertCookieData(o,s.getState().tabGroup));});});}else (function(){var r=l.convertCookieData(o);if(r.tabs.length>0)q.$FantaTabsSlimApp2(function(){c('ifRequired')('FantaTabActions',function(s){s.loadFromData(r);});});})();}.bind(this));n.doSync();m.get().handleUpdate(k);c('ChatPerfInstrumentation').logInitData();}.bind(this));};j.prototype.$FantaTabsSlimApp2=function(k){c('ifRequired')('FantaAppStore',function(l){k();},function(){c('Bootloader').loadModules(["FantaAppStore","FantaCookieUtil","FantaMessageActions","FantaTabActions","FantaTabViewportManager","PresenceState"],function(l,m,n,o,p,q){q.registerStateStorer(function(r){return m.createCookieData(l.getState().tabGroup,r);});l.addListener(function(){return q.doSync();});c('ReactDOM').render(this.getViewComponent(),this.tabsElem);p.init(this.tabsElem);this.$FantaTabsSlimApp1=true;k();}.bind(this),'FantaTabsSlimApp');}.bind(this));};j.prototype.initializeFantaUI=function(){e(['FantaMercuryThreadEventsBootloaded','FantaMessageActions','FantaTabActions','FantaTabViewportManager','FBRTCMessageHandler','MercuryBrowserAlerts'],function(k,l,m,n,o,p){o.init();p.init();k.onMessagesReceived(this.$FantaTabsSlimApp3);c('ChatPerfInstrumentation').logInitUI();c('ChatPerfInstrumentation').logDisplayDone();}.bind(this));};f.exports=new j();}),null);